CREATE MULTISET VOLATILE TABLE SELL_DETAIL AS 
( SELECT A.USER_ID, A.SEGM, A.ITEM_ID, B.TRANSACTION_ID, B.CREATED_DT AS SELL_DATE, CAST(B.ITEM_PRICE*B.LSTG_CURNCY_EXCHNG_RATE AS DECIMAL(18,2)) AS SELL_PRICE, B.QUANTITY, CAST(B.ITEM_PRICE*B.LSTG_CURNCY_EXCHNG_RATE*B.QUANTITY AS DECIMAL(18,2)) AS GMV 
    FROM LIST_DETAIL AS A 
    INNER JOIN ACCESS_VIEWS.DW_CHECKOUT_TRANS AS B ON A.USER_ID = B.SELLER_ID 
    AND A.ITEM_ID = B.ITEM_ID 
    AND B.CREATED_DT BETWEEN '2016-04-05' AND '2016-05-16' 
    AND B.CREATED_DT BETWEEN A.CMPGN_SENT_DT AND CAST(A.CMPGN_SENT_DT AS DATE)+42 
    AND B.AUCT_END_DT >= '2016-04-05' 
    AND B.RPRTD_WACKO_YN = 'N' 
    AND B.CK_WACKO_YN = 'N' ) 
WITH DATA PRIMARY INDEX (USER_ID,SEGM,ITEM_ID,TRANSACTION_ID) 
ON COMMIT PRESERVE ROWS ;
